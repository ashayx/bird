var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bird=function(t){function e(){var e=t.call(this)||this;return e.init(),e.x=280,e.y=400,e.isAlive=!0,e.scaleNum=3,e.jumpHeight=80,e.g=.5,e.rotation=0,e}return __extends(e,t),e.prototype.init=function(){var t=RES.getRes("bird_json"),e=RES.getRes("bird_png"),i=new egret.MovieClipDataFactory(t,e),r=new egret.MovieClip(i.generateMovieClipData("bird"));r.x=this.x,r.y=this.y,r.anchorOffsetX+=r.width/2,r.anchorOffsetY+=r.height/2,r.x+=r.width/2,r.y+=r.height/2,r.rotation=this.rotation,r.scaleX=3,r.scaleY=3,r.gotoAndPlay(0,-1),this.addChild(r)},e.prototype.fallDown=function(){this.y+=this.g,this.g+=.5,this.rotation+=5,this.rotation>=90&&(this.rotation=90),this.y>=SHEIGHT-75-136&&(this.y=SHEIGHT-75-136,this.die())},e.prototype.jump=function(){this.y-=this.jumpHeight,this.g=0,this.rotation=-60,this.y<=0&&(this.y=0)},e.prototype.die=function(){this.isAlive=!1},e}(egret.Sprite);__reflect(Bird.prototype,"Bird");var SceneEnd=function(t){function e(e){var i=t.call(this)||this;return i.score=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.createSceneTitle,i),i}return __extends(e,t),e.prototype.createSceneTitle=function(){var t=this,e=this.stage.stageWidth,i=this.stage.stageHeight;this.addEventListener(egret.Event.ENTER_FRAME,function(){},this),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var r=this.createBitmapByName("bg");this.addChild(r),r.width=e,r.height=i;var n=this.createBitmapByName("text_game_over_png");this.addChild(n),n.x=.1*e,n.y=.1*i,n.width=.8*e,n.height=200,this.textField=new egret.BitmapText;var o=RES.getRes("font_fnt");this.textField.font=o,this.addChild(this.textField),this.textField.x=280,this.textField.y=600,this.textField.text=""+this.score,this.textField.letterSpacing=2,this.textField.textAlign="center",this.addChild(this.textField);var s=this.createBitmapByName("button_ok_png");this.addChild(s),s.x=.45*e,s.y=.6*i,s.width=100,s.height=50,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.stage.addChild(new sceneTitle),t.stage.removeChild(t),console.log("重新开始")},this);var a=this.createBitmapByName("ground_png");this.addChild(a),a.x=0,a.y=i-136,a.width=2*e,a.height=136},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);__reflect(SceneEnd.prototype,"SceneEnd");var game=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.score=0;var e=this.createBitmapByName("bg");this.addChild(e),e.width=SWIDTH,e.height=SHEIGHT,this.textField=new egret.BitmapText;var i=RES.getRes("font_fnt");this.textField.font=i,this.addChild(this.textField),this.textField.x=280,this.textField.y=200,this.textField.text=""+this.score,this.textField.letterSpacing=2,this.textField.textAlign="center",this.addChild(this.textField),this.bird=new Bird,this.addChild(this.bird);var r=new Ground;this.addChild(r),egret.Ticker.getInstance().register(this.onTick,this),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.bird.jump()},this)},e.prototype.onTick=function(t){this.bird.fallDown(),this.bird.isAlive||(this.stage.addChild(new SceneEnd(this.score)),this.stage.removeChild(this),egret.Ticker.getInstance().unregister(this.onTick,this)),this.textField.text=""+this.score},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);__reflect(game.prototype,"game");var Ground=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Bitmap;t.texture=RES.getRes("ground_png"),this.addChild(t),t.x=0,t.y=SHEIGHT-136,t.width=2*SWIDTH,t.height=136;var e=egret.Tween.get(t,{loop:!0});e.to({x:-SWIDTH},2500)},e.prototype.move=function(){},e}(egret.Sprite);__reflect(Ground.prototype,"Ground");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){SWIDTH=this.stage.stageWidth,SHEIGHT=this.stage.stageHeight,this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){this.stage.addChild(new sceneTitle),this.stage.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var sceneTitle=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createSceneTitle,e),e}return __extends(e,t),e.prototype.createSceneTitle=function(){var t=this,e=this.createBitmapByName("bg");this.addChild(e),e.width=SWIDTH,e.height=SHEIGHT;var i=this.createBitmapByName("text_ready_png");this.addChild(i),i.x=100,i.y=100;var r=this.createBitmapByName("button_play_png");this.addChild(r),r.x=200,r.y=700,r.width=116,r.height=70;var n=new Bird;this.addChild(n);var o=new Ground;this.addChild(o),r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("开始"),t.stage.addChild(new game),t.stage.removeChild(t)},this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);__reflect(sceneTitle.prototype,"sceneTitle");